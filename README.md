# YOLOv11n-P2 for VisDrone - å¾®å°ç›®æ ‡æ£€æµ‹é¡¹ç›®

> åŸºäº YOLOv11n çš„æ— äººæœºèˆªæ‹å¾®å°ç›®æ ‡æ£€æµ‹ï¼Œé€šè¿‡ P2 é«˜åˆ†è¾¨ç‡æ£€æµ‹å¤´å’Œç©ºæ´å·ç§¯å¢å¼ºæ€§èƒ½ã€‚

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
CV/Project/
â”œâ”€â”€ yolo11n.yaml            # Baseline é…ç½®
â”œâ”€â”€ yolov11n-p2.yaml        # P2 é«˜åˆ†è¾¨ç‡æ£€æµ‹å¤´
â”œâ”€â”€ yolov11n-p2-dilated.yaml # P2 + ç©ºæ´å·ç§¯ï¼ˆæ‹”é«˜ç‰ˆï¼‰
â”œâ”€â”€ VisDrone.yaml           # æ•°æ®é›†é…ç½®
â”œâ”€â”€ ablation_study.py       # æ¶ˆèå®éªŒè„šæœ¬ï¼ˆæ¨èï¼‰
â”œâ”€â”€ start_train.py          # å•æ¨¡å‹è®­ç»ƒï¼ˆå¤‡ç”¨ï¼‰
â”œâ”€â”€ eval.py                 # æ¨¡å‹è¯„ä¼°
â”œâ”€â”€ demo_inference.py       # SAHI æ¨ç†å¯¹æ¯”
â”œâ”€â”€ technical_details.md    # æŠ€æœ¯åŸç†è¯¦è§£
â””â”€â”€ README.md               # æœ¬æ–‡ä»¶
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```powershell
pip install ultralytics sahi opencv-python
```

### 2. æ¶ˆèå®éªŒè®­ç»ƒï¼ˆ3 ä¸ªæ¨¡å‹ï¼‰

#### æ–¹å¼ Aï¼šå•ç‹¬è®­ç»ƒï¼ˆæ¨èï¼Œçµæ´»æ§åˆ¶ï¼‰

```powershell
# è®­ç»ƒ Baseline æ¨¡å‹
python ablation_study.py train 1

# è®­ç»ƒ P2 æ¨¡å‹
python ablation_study.py train 2

# è®­ç»ƒ P2+Dilated æ¨¡å‹
python ablation_study.py train 3

# å¯¹æ¯”æ‰€æœ‰å·²è®­ç»ƒæ¨¡å‹
python ablation_study.py compare
```

#### æ–¹å¼ Bï¼šä¸€é”®è®­ç»ƒå…¨éƒ¨

```powershell
python ablation_study.py train all
```

**è¯´æ˜ï¼š**
- é¦–æ¬¡è¿è¡Œä¼šè‡ªåŠ¨ä¸‹è½½ VisDrone æ•°æ®é›†ï¼ˆ~50-100 GBï¼‰å’Œé¢„è®­ç»ƒæƒé‡ï¼ˆ~6 MBï¼‰
- æ¯ä¸ªæ¨¡å‹è®­ç»ƒçº¦ 2-3 å°æ—¶ï¼ˆ100 epochsï¼ŒRTX 4060 8GBï¼‰
- è¾“å‡ºä¿å­˜åœ¨ `runs/ablation/*/weights/best.pt`

### 3. æ¨¡å‹è¯„ä¼°

```powershell
# è¯„ä¼°æœ€ä½³æ¨¡å‹
python eval.py --model runs/ablation/3_yolov11n_p2_dilated/weights/best.pt

# æˆ–è¯„ä¼°å…¶ä»–æ¨¡å‹
python eval.py --model runs/ablation/1_baseline_yolov11n/weights/best.pt
```

### 4. SAHI æ¨ç†å¯¹æ¯”

```powershell
# è¿è¡Œ SAHI åˆ‡ç‰‡æ¨ç† vs åŸç”Ÿ YOLO å¯¹æ¯”
python demo_inference.py --model runs/ablation/3_yolov11n_p2_dilated/weights/best.pt
```

ç»“æœä¿å­˜åœ¨ `demo_result/`ï¼ŒåŒ…å«ï¼š
- `sahi_result.jpg` - åˆ‡ç‰‡æ¨ç†ç»“æœï¼ˆå¾®å°ç›®æ ‡æ£€æµ‹æ›´å¥½ï¼‰
- `native_yolo/` - åŸç”Ÿæ¨ç†ç»“æœï¼ˆé€Ÿåº¦æ›´å¿«ï¼‰

---

## ğŸ“Š æ¨¡å‹å¯¹æ¯”

| æ¨¡å‹ | æ£€æµ‹å¤´ | P2 å±‚ | è†¨èƒ€å·ç§¯ | å‚æ•°é‡ | é¢„æœŸ mAP@0.5 |
|------|--------|-------|---------|--------|-------------|
| **Baseline** | P3/P4/P5 | âŒ | âŒ | 6.3M | ~40-45% |
| **P2** | P2/P3/P4/P5 | âœ… | âŒ | 6.4M | ~48-52% (+5-7%) |
| **P2+Dilated** | P2/P3/P4/P5 | âœ… | âœ… | 6.5M | ~50-54% (+2-3%) |

**æ¶ˆèå®éªŒè®¾è®¡ï¼š**
```
Baseline â†’ è¡¡é‡åŸºçº¿æ€§èƒ½
   â†“
P2 â†’ è¡¡é‡ P2 é«˜åˆ†è¾¨ç‡å¤´çš„è´¡çŒ®
   â†“
P2+Dilated â†’ è¡¡é‡è†¨èƒ€å·ç§¯çš„å¢é‡è´¡çŒ®
```

---

## ğŸ”¬ æ ¸å¿ƒæŠ€æœ¯æ”¹è¿›

### 1. P2 é«˜åˆ†è¾¨ç‡æ£€æµ‹å¤´

**åŸç†**ï¼šåœ¨æ ‡å‡† P3/P4/P5 æ£€æµ‹å¤´åŸºç¡€ä¸Šï¼Œå¢åŠ  P2 å±‚ï¼ˆ1/4 ä¸‹é‡‡æ ·ï¼‰

```
ä¼ ç»Ÿ YOLO:  P3(1/8) â†’ P4(1/16) â†’ P5(1/32)
æ”¹è¿›æ–¹æ¡ˆ:   P2(1/4) â†’ P3(1/8) â†’ P4(1/16) â†’ P5(1/32)
```

**ä¼˜åŠ¿**ï¼š
- ä¿ç•™ 4 å€ä¸‹é‡‡æ ·çš„æµ…å±‚ç‰¹å¾ï¼ˆçº¹ç†ã€è¾¹ç¼˜ï¼‰
- æ£€æµ‹ 16Ã—16 ä»¥ä¸Šçš„å¾®å°ç›®æ ‡
- å¯¹ < 32Ã—32 åƒç´ ç›®æ ‡å¬å›ç‡æå‡ 5-7%

### 2. ç©ºæ´æ·±åº¦å·ç§¯ï¼ˆæ‹”é«˜é¡¹ï¼‰

**åŸç†**ï¼šé€šè¿‡è†¨èƒ€å·ç§¯æ ¸æ‰©å¤§æ„Ÿå—é‡è€Œä¸å¢åŠ å‚æ•°

```
æ ‡å‡†å·ç§¯ 3Ã—3:        ç©ºæ´å·ç§¯ 3Ã—3 (dilation=2):
[â– ][â– ][â– ]           [â– ][ ][â– ][ ][â– ]
[â– ][â– ][â– ]           [ ][ ][ ][ ][ ]
[â– ][â– ][â– ]           [â– ][ ][â– ][ ][â– ]
æ„Ÿå—é‡: 3Ã—3          æ„Ÿå—é‡: 5Ã—5
```

**ä¼˜åŠ¿**ï¼š
- æ•è·æ›´å¤šä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ˆå‘¨å›´é“è·¯ã€å»ºç­‘ï¼‰
- å‚æ•°é‡å¢åŠ  < 0.1M
- è¿›ä¸€æ­¥æå‡å¾®å°ç›®æ ‡è¯†åˆ«ç‡ 2-3%

### 3. SAHI åˆ‡ç‰‡æ¨ç†

**åŸç†**ï¼šå°†é«˜åˆ†è¾¨ç‡å›¾åƒåˆ‡ç‰‡ååˆ†åˆ«æ¨ç†ï¼Œå†åˆå¹¶ç»“æœ

```python
get_sliced_prediction(
    image,
    model,
    slice_height=640,
    slice_width=640,
    overlap_ratio=0.2  # 20% é‡å é¿å…è¾¹ç•Œæ¼æ£€
)
```

**ä¼˜åŠ¿**ï¼š
- è§£å†³å›¾åƒç¼©æ”¾å¯¼è‡´çš„ä¿¡æ¯æŸå¤±
- å±€éƒ¨è§†é‡ä¸­å¾®å°ç›®æ ‡æ›´æ¸…æ™°
- é€‚åˆ > 1920Ã—1080 çš„é«˜åˆ†è¾¨ç‡å›¾åƒ

**è¯¦ç»†æŠ€æœ¯åŸç†**ï¼šè§ `technical_details.md`

---

## ğŸ“ è¾“å‡ºæ–‡ä»¶è¯´æ˜

è®­ç»ƒå’Œæ¨ç†ä¼šç”Ÿæˆä»¥ä¸‹æ–‡ä»¶ï¼š

```
runs/
â””â”€â”€ ablation/
    â”œâ”€â”€ 1_baseline_yolov11n/
    â”‚   â”œâ”€â”€ weights/best.pt          # æœ€ä½³æ¨¡å‹
    â”‚   â”œâ”€â”€ results.csv              # è®­ç»ƒæŒ‡æ ‡
    â”‚   â””â”€â”€ results.png              # è®­ç»ƒæ›²çº¿
    â”œâ”€â”€ 2_yolov11n_p2/
    â”‚   â””â”€â”€ ...
    â”œâ”€â”€ 3_yolov11n_p2_dilated/
    â”‚   â””â”€â”€ ...
    â””â”€â”€ results_summary.json         # å¯¹æ¯”æ±‡æ€»

demo_result/
â”œâ”€â”€ sahi_result.jpg                  # SAHI æ¨ç†ç»“æœ
â””â”€â”€ native_yolo/predict/             # åŸç”Ÿæ¨ç†ç»“æœ
```

---

## ğŸ› ï¸ å¸¸è§é—®é¢˜

**Q1: è®­ç»ƒå¤±è´¥ï¼Œæç¤ºæ‰¾ä¸åˆ°é…ç½®æ–‡ä»¶ï¼Ÿ**
```powershell
# ç¡®ä¿åœ¨é¡¹ç›®ç›®å½•ä¸‹è¿è¡Œ
cd E:\trAshbaGrepository\CV\Project
python ablation_study.py train 1
```

**Q2: æ˜¾å­˜ä¸è¶³ (OOM)ï¼Ÿ**
```python
# ä¿®æ”¹ ablation_study.py ç¬¬ 87 è¡Œ
batch=8  # ä» 16 æ”¹ä¸º 8
```

**Q3: æ•°æ®é›†ä¸‹è½½å¾ˆæ…¢ï¼Ÿ**
- å¯ä» [VisDrone å®˜ç½‘](http://aiskyeye.com/) æ‰‹åŠ¨ä¸‹è½½
- è§£å‹åˆ° `datasets/VisDrone/`

**Q4: æƒ³è·³è¿‡æŸä¸ªæ¨¡å‹çš„è®­ç»ƒï¼Ÿ**
- å®Œå…¨å¯ä»¥ï¼Œåªè®­ç»ƒéœ€è¦çš„æ¨¡å‹å³å¯
- å¯¹æ¯”æ—¶ä¼šè‡ªåŠ¨è¯†åˆ«å·²å®Œæˆçš„æ¨¡å‹

**Q5: å¦‚ä½•ä¿®æ”¹è®­ç»ƒè½®æ•°ï¼Ÿ**
```powershell
# è®­ç»ƒ 50 è½®ï¼ˆå¿«é€Ÿå®éªŒï¼‰
python ablation_study.py train 1 50

# è®­ç»ƒ 150 è½®ï¼ˆå®Œæ•´å®éªŒï¼‰
python ablation_study.py train 1 150
```

---

## ğŸ“š å‚è€ƒèµ„æº

- **YOLOv11 å®˜æ–¹æ–‡æ¡£**: https://docs.ultralytics.com/models/yolo11/
- **SAHI é¡¹ç›®**: https://github.com/obss/sahi
- **VisDrone æ•°æ®é›†**: http://aiskyeye.com/
- **æŠ€æœ¯ç»†èŠ‚æ–‡æ¡£**: `technical_details.md`

---

## ğŸ“ å¼•ç”¨

å¦‚æœæœ¬é¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿å¼•ç”¨ï¼š

```bibtex
@misc{yolov11n-p2-visdrone,
  title={YOLOv11n-P2: High-Resolution Feature Pyramid for Tiny Object Detection},
  author={Your Name},
  year={2025},
  howpublished={\url{https://github.com/your-repo}}
}
```

---

## âœ… é¡¹ç›®å®Œæˆæ ‡å‡†

- [ ] å®Œæˆ 3 ä¸ªæ¨¡å‹è®­ç»ƒï¼ˆBaseline, P2, P2+Dilatedï¼‰
- [ ] ç”Ÿæˆå¯¹æ¯”ç»“æœ (`results_summary.json`)
- [ ] è¿è¡Œ SAHI æ¨ç†å¯¹æ¯”
- [ ] æ•´ç†è®­ç»ƒæ›²çº¿å’Œæ¨ç†ç»“æœæˆªå›¾
- [ ] æ’°å†™å®éªŒæŠ¥å‘Šï¼ˆåŒ…å« mAP å¯¹æ¯”è¡¨ã€å¯è§†åŒ–ç»“æœï¼‰

**ç°åœ¨å°±å¼€å§‹è®­ç»ƒå§ï¼** ğŸš€

